\newcommand\optionDef[2]{\shortForm{#1}, \longForm{#2}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Invoking Helena}
\label{section_invoking_helena}
Using Helena consists of writing the description of the high level net
in a file (called the net file thereafter), e.g., \texttt{my-net.lna},
and the properties expressed on this net in a second file (called the
property file thereafter), e.g., \texttt{my-net.prop.lna}, and to
invoke Helena on this file.  The command line of Helena has the
following form:
\begin{center}
\begin{verbatim}
helena [option ... option] my-net.lna
\end{verbatim}
\end{center}

When invoked, Helena proceeds as follows:
\begin{enumerate}
\item If the net described in file \texttt{my-net.lna} is
  \texttt{my-net}, the directory \texttt{\~{}/.helena/models/lna/my-net}
  is created.
\item A set of C source files and a Makefile are put in directory
  \texttt{\~{}/.helena/models/lna/my-net/src}.
\item These files are compiled and an executable is created which
  corresponds to the actual model checker for the specific net.
\item The compiled executable is launched.
\item Once the search is finished, a report is displayed on the
  standard output.  If a property was checked, this report indicates
  whether the desired property is verified or not.  In the second
  case, a path leading from the initial marking to the faulty marking
  is displayed.
\end{enumerate}

Each option has a short form preceded by a single \texttt{-} and a
long form preceded by \longForm{}.  Most options take an argument.  To
invoke Helena on a file \texttt{my-net.lna} with an option
\texttt{opt} having argument \texttt{arg}, simply type \texttt{helena
  -opt=arg my-net.lna}.  In addition, let us note that the options are
interpreted in the order in which they are found.  Hence, in case of
conflicting options, the last ones will prevail.

\subsection{General options}
\begin{description}
\item\optionDef{h}{help}\\ Prints a help message and exit.
\item\optionDef{V}{version}\\ Prints the version number and exit.
\item\optionDef{v}{verbose}\\ This option activates the verbose
  mode.  Helena prints a message at each step.
\item\optionDef{N}{action=ACTION}\\
  This indicates the action performed by Helena on the model.
  \texttt{ACTION} must have one of the following values:
  \begin{itemize}
  \item\texttt{EXPLORE} --- Helena explores the state space of the
    model and then prints some statistics.  This is the default.
  \item\texttt{SIMULATE} --- Starts helena in interactive simulation
    mode.  You can then navigate through the reachability graph of the
    model by executing transitions, undoing transitions,\ldots A
    simple command language is provided.  Once the simulation is
    started, type \texttt{help} to see the list of commands.
  \item\texttt{BUILD-GRAPH} --- Helena builds the reachability graph
    of the model using a search algorithm \texttt{DELTA-DDD} (see
    option \texttt{algo}) and store it on disk.  This graph can then
    be analyzed using the \toolName{helena-graph} tool (see
    Section~\ref{sec:helena-graph}).
  \item\texttt{CHECK-prop} --- Helena checks whether or not property
    \texttt{prop} (which must be a property defined in the model file)
    is verified.
  \end{itemize}
\item\optionDef{p}{property-file=FILE-NAME}\\
  File \texttt{FILE-NAME} contains the definition of the property to
  check specified with option \longForm{action=CHECK-prop}.  By
  default, if the input file of the model is \texttt{model.lna},
  Helena will try opening file \texttt{model.prop.lna} to look for the
  property definition.
\item\optionDef{md}{model-directory=DIRECTORY}\\
  All generated files such as source files are put in directory
  \texttt{DIRECTORY} instead of
  \texttt{\~{}/.helena/models/lna/my-net}.
\end{description}

\subsection{Search options}
\begin{description}
\item\optionDef{A=ALGO-TYPE}{algo=ALGO-TYPE}\\ This option is used
  to indicate to Helena the type of search that must be used to
  explore the state space. Five search modes are available. They
  correspond to the three following possible values for parameter
  \texttt{ALGO-TYPE}:
\begin{itemize}
\item\texttt{DFS} --- The state space is explored using a depth-first
  search.  This is the default.
\item\texttt{BFS} --- The state space is explored using a
  breadth-first search.
\item\texttt{FRONTIER} --- The state space is explored using a
  breadth-first search but only the states of the current level are
  kept in memory.  This algorithm will not terminate if the state
  space contains cycles.
\item\texttt{DELTA-DDD} --- The state space is explored using a
  parallel breadth-first search based on state compression.
\item\texttt{RWALK} --- Helena explores the state space using a
  random walk.  The principle is to randomly select at each state an
  enabled transition, execute it and reiterate this process.  The walk
  is reinitiated each time a deadlock state is met.  If no limit is
  specified (see Section~\ref{subsection:limits}) the search will last
  forever.
\end{itemize}
\item\optionDef{t=N}{hash-size=N}\\ Set the size of the hash table
  which stores the set of reachable markings to $2^N$.  The default
  value is 22.
\item\optionDef{W=N}{workers=N}\\ Specify the number of working
  threads that will perform the search.  This option is only usable if
  the search algorithm is \texttt{DELTA-DDD} or \texttt{RWALK}.
\item\optionDef{cs=N}{candidate-set-size=N}\\ Set the cache size of
  algorithm \texttt{DELTA-DDD}.  100~000 is the default value.
  Increasing it may consume more memory but can fasten the search.
\end{description}


\subsection{Reduction techniques}
\begin{description}
\item\optionDef{H}{hash-compaction}\\ The hash compaction storage
  method is used.  Its principle is to only store a hash signature of
  each visited state.  In case of hash conflict, Helena will not
  necessarily explore the whole state space and may report that no
  error has been found whereas one could exist.
\item\optionDef{P}{partial-order}\\ Specify if partial order
  reductions are applied during the search.  Partial order methods try
  to alleviate the state explosion problem by limiting the exploration
  of multiple paths that are redundant with respect to the desired
  property.  This causes some states to be never explored during the
  search.  The reductions done depend on the property verified.  If
  there is no property checked, the reduction done only preserves the
  existence of deadlock states.
\item\optionDef{S}{state-caching}\\ The principle of state caching is
  to only store a subset of visited states in such a way that
  termination is still guaranteed.  Other visited states are
  forgotten.  This technique can be very efficient but can also
  considerably increase the execution time by revisiting forgotten
  states.
\end{description}

\subsection{Search limits}
\label{subsection:limits}
\begin{description}
\item\optionDef{ml=N}{memory-limit=N}\\ The memory used by Helena is
  limited to \texttt{N}\% of the available RAM.  When this limit is
  reached the search stops as soon as possible.
\item\optionDef{tl=N}{time-limit=N}\\ The search time is limited to
  \texttt{N} seconds.  When this limit is reached the search stops as
  soon as possible.
\item\optionDef{sl=N}{state-limit=N}\\ As soon as \texttt{N} states
  have been visited the search is stopped as soon as possible.
\end{description}

\subsection{Model options}
\begin{description}
\item\optionDef{d=SYMBOL-NAME}{define=SYMBOL-NAME}\\ Define
  preprocessor symbol \texttt{SYMBOL-NAME}.
\item\optionDef{a=N}{capacity=N}\\ The default capacity of places is
  set to \texttt{N}.
\item\optionDef{r}{run-time-checks}\\ Activate run time checks such
  as: division by 0, expressions out of range, capacity of places
  exceeded, \dots. If this option is not activated, and such an error
  occurs during the analysis, Helena may either crash, either produce
  wrong results.
\item\optionDef{L}{link=OBJECT-FILE}\\ Add file \texttt{OBJECT-FILE}
  to the files linked by Helena when compiling the net.  Please
  consult Chapter~\ref{chapter_interfacing} for further help on this
  option.
\item\optionDef{m=p=i}{parameter=p=i}\\ This gives value \texttt{i}
  (an integer) to net parameter \texttt{p}.
\end{description}

\subsection{Output}
\begin{description}
\item\optionDef{o=FILE-NAME}{report-file=FILE-NAME}\\ An XML report
  file is created by Helena once the search terminated.  It contains
  some informations such as the result of the search, or some
  statistics.  Please report to Section~\ref{section_output_report}
  for further indications on this report.
\item\optionDef{tr}{trace-type}\\ Specify the type of trace
  displayed:
\begin{itemize}
\item\texttt{FULL} --- The full trace is displayed.
\item\texttt{EVENTS} --- Only the sequence of events, the initial and
  the final faulty states are displayed.  Intermediary states are not
  displayed.
\item\texttt{STATE} --- Only the faulty state reached is displayed.  No
  information on how this state can be reached is therefore available.
\end{itemize}
\end{description}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The output report}
\label{section_output_report}
Once the search terminated, Helena prints a report to the standard
output.  This section details the structure of this report.

\subsection{Structure of the report}
This report is composed of four distinct parts: the information report, the
search report, the trace report and the statistics report.

\subsubsection{The information report}
This first report contain general informations, such as the name of the net
verified and the date of analysis.

\subsubsection{The search report}
This report contains various informations on the search such as the
termination state of the search or the options enabled, e.g., partial
order. The search can terminate in different ways: the property is
verified, the property does not hold, the search ran out of memory,
\ldots

\subsubsection{The trace report}
When the property specified does not hold, Helena reports in a trace
report the faulty execution discovered.  In the case of state
property, this execution consists of a sequence of states $s_0, \dots,
s_n$ such that $s_0$ is the initial state and $s_n$ is the faulty
state reached by Helena.  For LTL properties this consists of an
infinite execution violating the temporal property.

\subsubsection{The statistics report}
The statistics report is the last part of the report printed by Helena
after the search.  This report simply consists of a set of statistics
collected by Helena. The statistics reported gives various
informations on the analyzed net, the size of the reachability graph,
or the memory consumption.  Let us point out that the type of
statistics displayed depend on the option passed to Helena.  For
instance, no statistic concerning the reachability graph are available
in a fast simulation mode.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Generating reports}
Helena can produce an XML report file corresponding of the report
displayed when it is invoked with option \longForm{report-file}.  The
purpose of XML reports is to ease the interface between Helena and
other tools.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Additional utilities}
\label{section_utilities}
Together with Helena are installed several utilities that we briefly
describe here.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{The \toolName{helena-report} utility}
The purpose of \toolName{helena-report} is to print an XML report that
has been created by Helena.  This utility is useful in the case where
you have already invoked Helena on a net and you do not want to launch
the search again.  Here is an example of use of this utility:
\begin{verbatim}
helena my-net.lna
helena-report my-net
\end{verbatim}
where \texttt{my-net} is the name of the net of file \texttt{my-net.lna}.
The search report will then be printed to the standard output.\\
Alternatively, you can directly pass to \toolName{helena-report} an
xml report previously generated.  For example the following sequence
of commands is equivalent to the previous one:
\begin{verbatim}
helena --report-file=my_report.xml my-net.lna
helena-report my_report.xml
\end{verbatim}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{The \toolName{helena-graph} utility}
\label{sec:helena-graph}
Helena can build the reachability graph of net in order to display
some statistics on, e.g., its strongly connected components.  This is
the purpose of the \longForm{action=BUILD-GRAPH} option.  This option
is only meaningful if used in conjunction with the
\toolName{helena-graph} utility.  Let us assume that the file
\texttt{my-net.lna} contains the description of net \texttt{my-net}.
A typical use of this combination is
\begin{verbatim}
helena --action=BUILD-GRAPH my-net.lna
helena-graph my-net my_rg_report.pdf
\end{verbatim}
\begin{itemize}
\item The first command explores the reachability graph of the net and
  stores it on disk in the model directory (in \texttt{\~{}/.helena},
  by default).
\item The second command reads this file and produces a report
  containing various informations on the graph e.g., in-/out-degrees
  of nodes, shape of the BFS level graph, SCCs of the graph, dead
  markings, live transitions, \ldots
\end{itemize}
The output format of this report can be pdf or xml.  In the case of a
pdf report, you will need pdflatex as well as the Gnuplot python
library on your system.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{The \toolName{helena-generate-interface} utility}
This tool is used to generate a C header file containing the
translation of types, constants, and functions that can then be used
in imported modules.  Please consult Chapter~\ref{chapter_interfacing}
for further help on this tool.
